---
title: PostgreSQL で json
author: shiroccho
layout: post
date : 2025-05-06T18:10
category: 雑記
---
- 仕事でプリザンターをいじってました。プリザンターで着手するワークフローはプリザンターで完結してほしいんですが、現場はなぜか印刷、または A4 フォーマットでPDF出力したがります。なので、プリザンターのバックエンドに使っている PostgreSQL から MS Access にデータを拾ってきて「印刷をするアプリ」を作ることになるんですが、MS Access ってあんま使わないんでよくわからないんですよね。なんとなくパススルークエリ使ってデータ抜いてきて書式作っていくわけなんですけど、今日は手強かった。

- プリザンターのデータってあんまり正規化されてないんで引っ張りやすいんですが、今回はフォームのパーツにくっついてるラベルのデータが必要でした。いつもみたく簡単に引っ張れるかなーと思ったら、ネストした JSON で入ってた。text型からjsonにキャストもそんなに難しくなかったんだけど、MS Access から VBA --> パススルークエリで SQL句を流すとなんかうまく動かない。で、ジタバタしてました。

- 最終的にはなんとかなったんだけど、MS ACCESS いろんな罠が潜んでいたんで参りました。慣れなんだろうけど。

- ナレッジが溜まっていないことをやるのはしんどいです、すっごい簡単なことなのに全然できない。そして、役に立たないムダ知識が溜まっていくのが儚い。趣味なら良いんだけど仕事なんで。

Hack.bBARになんとなく来てる。仕事から直できたからモードが変わらない。